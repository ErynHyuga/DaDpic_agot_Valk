## Champion Amazonian Faith (this will reform the Amazon faith without need for holy sites, using a more limited selection of doctrines)
mz_champion_amazonian_faith_decision = {
	picture = "gfx/interface/illustrations/decisions/decision_major_religion.dds"
	major = yes
	cooldown = { days = 3650 }

	is_shown = {
		is_landed = yes
		exists = dynasty		
		culture = { mz_is_amazonian_culture = yes } # Amazon culture is required
		mz_amazon_ruler_trigger = yes # And you must be an Amazonian ruler
		any_held_title = {
			tier = tier_county
			culture = root.culture # Need at least one county of your Amazon culture
		}
		NOT = { # If there are more than one Heraionic faiths, then this faith has already been reformed via normal means and this decision is superflous
			religion:mz_heraionism_religion = { 
				any_faith = { count > 1 }
			}
		}
		NOT = { has_global_variable = mz_amazon_faith_decision_used } # Haven't already changed the Amazonian faith
		has_global_variable = mz_amazon_kingdom_expanded # Kingdom has been expanded
		# Filter out anyone who's their own HoF, since they can't convert.
		trigger_if = {
			limit = { exists = faith.religious_head }
			NOT = { this = faith.religious_head }
		}
	}

	is_valid = {
		piety_level >= 3
		faith:mz_amazon_pagan = { has_doctrine = unreformed_faith_doctrine } # Only if unreformed!
		custom_description = {
			text = mz_champion_amazonian_faith_requirement
			OR = {
				any_vassal = {
					faith = faith:mz_amazon_pagan
				}
				any_courtier = {
					faith = faith:mz_amazon_pagan
				}
			}
		}
		capital_county = {
			NOT = { 
				title_province = { geographical_region = mz_hellenic_homeland }
			}
		}
	}

	is_valid_showing_failures_only = {
		is_available_at_peace_adult_lenient = yes
		is_female = yes
		is_independent_ruler = yes
	}

	cost = {
		piety = {
			value = 3000 # Start with a high value
			if = { 
				limit = { has_trait = zealous }
				add = massive_piety_value
			}
			if = {
				limit = { 
					NOT = { 
						faith = { has_doctrine = unreformed_faith_doctrine } # If faith is reformed this costs a lot
					}
				}
				add = massive_piety_value
			}
			if = { 
				limit = {
					NOT = { 
						faith = { has_doctrine = pagan_hostility_doctrine } # If faith is not-pagan it costs more
					}
				}
				add = massive_piety_value
			}			
			if = { # If we are sinful in the eyes of our current faith and/or virtuous in the eyes of the Amazon faith, it's a bit cheaper
				limit = { 
					OR = {
						num_sinful_traits >= 2
						num_virtuous_traits = {
							value >= 2
							faith = faith:mz_amazon_pagan
						}
						AND = {
							num_virtuous_traits = {
								value >= 1
								faith = faith:mz_amazon_pagan
							}
							num_sinful_traits >= 1					
						}
					}
				}
				subtract = major_piety_value
			}
			if = { # Friends or lovers with followers somewhat reduces cost
				limit = {
					OR = {
						any_relation = {
							type = friend
							faith = faith:mz_amazon_pagan
						}
						any_relation = {
							type = lover
							faith = faith:mz_amazon_pagan
						}
					}
				}
				subtract = major_piety_value
			}			
			if = { # Excommunicated means we have an easier time
				limit = { has_trait = excommunicated }
				subtract = major_piety_value
			}	
			if = { # Cynics have an easier time
				limit = { has_trait = cynical }
				subtract = major_piety_value
			}
			if = { # Zealots have a harder time
				limit = { has_trait = zealous }
				add = massive_piety_value
			}
			if = { # Rivals with HoF makes this easier
				limit = { 
					exists = faith.religious_head
					has_relation_rival = faith.religious_head
				}
				subtract = major_piety_value
			}								
			if = { # Apostate Perk (we are switching to a technically existing faith after all)
				limit = { has_perk = apostate_perk }
				multiply = 0.25
			}
			else_if = { # Prophet Perk (not exactly creating a new faith, but close enough)
				limit = { has_perk = prophet_perk }
				multiply = 0.5				
			}
			divide = 100
			round = yes
			multiply = 100
			min = major_piety_value
		}
	}

	effect = {
		set_global_variable = {
			name = mz_amazon_faith_decision_used
			value = yes
		}
		trigger_event = mz_religious_special.3001
		custom_tooltip = mz_champion_amazonian_faith_effect_tt
		show_as_tooltip = {
			faith:mz_amazon_pagan = { remove_doctrine = unreformed_faith_doctrine }
			if = {
				limit = { 
					NOT = { faith = faith:mz_amazon_pagan }
				}
				set_character_faith_with_conversion = faith:mz_amazon_pagan
			}
		}
	}
	
	ai_check_interval = 0
	ai_potential = {
		always = no
	}
	ai_will_do = {
		base = 0
	}	
}

## Find a new Faith for the Amazons
mz_find_new_amazonian_faith_decision = {
	picture = "gfx/interface/illustrations/decisions/decision_major_religion.dds"
	major = yes
	cooldown = { days = 3650 }

	is_shown = {
		is_landed = yes
		exists = dynasty		
		culture = { mz_is_amazonian_culture = yes } # Amazon culture is required
		mz_amazon_ruler_trigger = yes # And you must be an Amazonian ruler
		any_held_title = {
			tier = tier_county
			culture = root.culture # Need at least one county of your Amazon culture
		}
		NOT = { # If there are more than one Heraionic faiths, then this faith has already been reformed via normal means and this decision is superflous
			religion:mz_heraionism_religion = { 
				any_faith = { count > 1 }
			}
		}
		NOT = { has_global_variable = mz_amazon_faith_decision_used } # Haven't already changed the Amazonian faith
		has_global_variable = mz_amazon_kingdom_expanded # Kingdom has been expanded
		# Filter out anyone who's their own HoF, since they can't convert.
		trigger_if = {
			limit = { exists = faith.religious_head }
			NOT = { this = faith.religious_head }
		}
	}

	is_valid = {
		piety_level >= 4
		faith:mz_amazon_pagan = { has_doctrine = unreformed_faith_doctrine } # Only if unreformed!
		custom_description = {
			text = mz_champion_amazonian_faith_requirement
			OR = {
				any_vassal = {
					faith = faith:mz_amazon_pagan
				}
				any_courtier = {
					faith = faith:mz_amazon_pagan
				}
			}
		}
		capital_county = {
			NOT = { 
				title_province = { geographical_region = mz_hellenic_homeland }
			}
		}
	}

	is_valid_showing_failures_only = {
		is_available_at_peace_adult_lenient = yes
		is_female = yes
		is_independent_ruler = yes
	}

	widget = {
		gui = "decision_view_widget_generic_multichoice_with_effects"
		controller = decision_option_list_controller
		decision_to_second_step_button = "MZ_CHOOSE_FAITH"
	
		item = { # Tengrism
			value = mz_find_new_amazonian_faith_decision_tengri
			is_shown = {
				religion:tengrism_religion = { 
					any_faith = { count <= 1 }
				}		
				NOT = {
					capital_county.title_province  = { geographical_region = world_africa }					
				}	
			}
			is_valid = {
				faith:tengri_pagan = { has_doctrine = unreformed_faith_doctrine }
				NOT = { exists = faith:tengri_pagan.religious_head }
			}
			current_description = mz_find_new_amazonian_faith_decision_tengri_desc
			localization = mz_find_new_amazonian_faith_decision_tengri_option
			icon = "gfx/interface/icons/faith/tengri.dds"
			ai_chance = { value = 0 } # Currently unused
		}
		item = { # Táltosism
			value = mz_find_new_amazonian_faith_decision_taltosism
			is_shown = {
				religion:magyar_religion = { 
					any_faith = { count <= 1 }
				}	
				NOT = {
					capital_county.title_province  = { geographical_region = world_africa }					
				}		
			}
			is_valid = {
				faith:magyar_pagan = { has_doctrine = unreformed_faith_doctrine }
				NOT = { exists = faith:magyar_pagan.religious_head }
			}
			current_description = mz_find_new_amazonian_faith_decision_taltosism_desc
			localization = mz_find_new_amazonian_faith_decision_taltosism_option
			icon = "gfx/interface/icons/faith/pagan_magyar.dds"
			ai_chance = { value = 0 } # Currently unused
		}
		item = { # Siberian
			value = mz_find_new_amazonian_faith_decision_siberian
			is_shown = {
				religion:siberian_religion = { 
					any_faith = { count <= 1 }
				}	
				NOT = {
					capital_county.title_province  = { geographical_region = world_africa }					
				}			
			}
			is_valid = {
				faith:siberian_pagan = { has_doctrine = unreformed_faith_doctrine }
				NOT = { exists = faith:siberian_pagan.religious_head }				
			}
			current_description = mz_find_new_amazonian_faith_decision_siberian_desc
			localization = mz_find_new_amazonian_faith_decision_siberian_option
			icon = "gfx/interface/icons/faith/siberian.dds"
			ai_chance = { value = 0 } # Currently unused
		}
		item = { # Finnish
			value = mz_find_new_amazonian_faith_decision_finnish
			is_shown = {
				religion:finno_ugric_religion = { 
					any_faith = { count <= 1 }
				}
				NOT = {
					capital_county.title_province  = { geographical_region = world_africa }					
				}
			}
			is_valid = {
				faith:finnish_pagan = { has_doctrine = unreformed_faith_doctrine }
				NOT = { exists = faith:finnish_pagan.religious_head }
			}
			current_description = mz_find_new_amazonian_faith_decision_finnish_desc
			localization = mz_find_new_amazonian_faith_decision_finnish_option
			icon = "gfx/interface/icons/faith/finno_ugric.dds"
			ai_chance = { value = 0 } # Currently unused
		}
		item = { # Kabarism
			value = mz_find_new_amazonian_faith_decision_kabarism
			is_valid = {
				faith:kabarism = { has_doctrine = unreformed_faith_doctrine }
				NOT = { exists = faith:kabarism.religious_head }
			}
			current_description = mz_find_new_amazonian_faith_decision_kabarism_desc
			localization = mz_find_new_amazonian_faith_decision_kabarism_option
			icon = "gfx/interface/icons/faith/kabarism.dds"
			ai_chance = { value = 0 } # Currently unused
		}	
	}	

	cost = {
		piety = {
			value = 3000 # Start with a high value
			if = { 
				limit = { has_trait = zealous }
				add = massive_piety_value
			}
			if = {
				limit = { 
					NOT = { 
						faith = { has_doctrine = unreformed_faith_doctrine } # If faith is reformed this costs a lot
					}
				}
				add = massive_piety_value
			}
			if = { 
				limit = {
					NOT = { 
						faith = { has_doctrine = pagan_hostility_doctrine } # If faith is not-pagan it costs more
					}
				}
				add = massive_piety_value
			}			
			if = { # If we are sinful in the eyes of our current faith and/or virtuous in the eyes of the Amazon faith, it's a bit cheaper
				limit = { 
					OR = {
						num_sinful_traits >= 2
						num_virtuous_traits = {
							value >= 2
							faith = faith:mz_amazon_pagan
						}
						AND = {
							num_virtuous_traits = {
								value >= 1
								faith = faith:mz_amazon_pagan
							}
							num_sinful_traits >= 1					
						}
					}
				}
				subtract = major_piety_value
			}
			if = { # Friends or lovers with followers somewhat reduces cost
				limit = {
					OR = {
						any_relation = {
							type = friend
							faith = faith:mz_amazon_pagan
						}
						any_relation = {
							type = lover
							faith = faith:mz_amazon_pagan
						}
					}
				}
				subtract = major_piety_value
			}			
			if = { # Excommunicated means we have an easier time
				limit = { has_trait = excommunicated }
				subtract = major_piety_value
			}	
			if = { # Cynics have an easier time
				limit = { has_trait = cynical }
				subtract = major_piety_value
			}
			if = { # Zealots have a harder time
				limit = { has_trait = zealous }
				add = massive_piety_value
			}
			if = { # Rivals with HoF makes this easier
				limit = { 
					exists = faith.religious_head
					has_relation_rival = faith.religious_head
				}
				subtract = major_piety_value
			}								
			if = { # Apostate Perk (we are switching to a technically existing faith after all)
				limit = { has_perk = apostate_perk }
				multiply = 0.25
			}
			else_if = { # Prophet Perk (not exactly creating a new faith, but close enough)
				limit = { has_perk = prophet_perk }
				multiply = 0.5				
			}
			divide = 100
			round = yes
			multiply = 100
			min = major_piety_value
		}
	}

	effect = {
		set_global_variable = {
			name = mz_amazon_faith_decision_used
			value = yes
		}
		custom_description_no_bullet = { text = mz_find_new_amazonian_faith_decision_effect_desc }
		if = {
			limit = { scope:mz_find_new_amazonian_faith_decision_tengri = yes }
			if = {
				limit = { 
					faith:tengri_pagan = { mz_dead_faith_trigger = yes }
				}
				mz_dead_faith_amazon_adoption_effect = { FAITH = faith:tengri_pagan }
			}
			else = { 
				mz_living_faith_amazon_adoption_effect = { FAITH = faith:tengri_pagan }
			}
			mz_generic_find_amazon_faith_effect = { FAITH = faith:tengri_pagan }
		}
		if = {
			limit = { scope:mz_find_new_amazonian_faith_decision_taltosism = yes }
			if = {
				limit = { 
					faith:magyar_pagan = { mz_dead_faith_trigger = yes }
				}
				mz_dead_faith_amazon_adoption_effect = { FAITH = faith:magyar_pagan }
			}
			else = { 
				mz_living_faith_amazon_adoption_effect = { FAITH = faith:magyar_pagan }
			}
			mz_generic_find_amazon_faith_effect = { FAITH = faith:magyar_pagan }
		}
		if = {
			limit = { scope:mz_find_new_amazonian_faith_decision_siberian = yes }
			if = {
				limit = { 
					faith:siberian_pagan = { mz_dead_faith_trigger = yes }
				}
				mz_dead_faith_amazon_adoption_effect = { FAITH = faith:siberian_pagan }
			}
			else = { 
				mz_living_faith_amazon_adoption_effect = { FAITH = faith:siberian_pagan }
			}
			mz_generic_find_amazon_faith_effect = { FAITH = faith:siberian_pagan }
		}
		if = {
			limit = { scope:mz_find_new_amazonian_faith_decision_finnish = yes }
			if = {
				limit = { 
					faith:finnish_pagan = { mz_dead_faith_trigger = yes }
				}
				mz_dead_faith_amazon_adoption_effect = { FAITH = faith:finnish_pagan }
			}
			else = { 
				mz_living_faith_amazon_adoption_effect = { FAITH = faith:finnish_pagan }
			}
			mz_generic_find_amazon_faith_effect = { FAITH = faith:finnish_pagan }
		}
		if = {
			limit = { scope:mz_find_new_amazonian_faith_decision_kabarism= yes }
			if = {
				limit = { 
					faith:kabarism = { mz_dead_faith_trigger = yes }
				}
				mz_dead_faith_amazon_adoption_effect = { FAITH = faith:kabarism }
			}
			else = { 
				mz_living_faith_amazon_adoption_effect = { FAITH = faith:kabarism }
			}
			mz_generic_find_amazon_faith_effect = { FAITH = faith:kabarism }
		}
	}
	
	ai_check_interval = 0
	ai_potential = {
		always = no
	}
	ai_will_do = {
		base = 0
	}	
}

## Adopt Amazonian Culture (Reforming moved to separate decision)
mz_become_amazon_decision = {
	picture = "gfx/interface/illustrations/decisions/mz_decision_recruit_amazon.dds"
	sort_order = 75
	#major = yes
	
	ai_check_interval = 0
	ai_potential = {
		is_landed = yes
		is_female = yes
	}
	ai_will_do = {
		base = 0
	}
	
	cooldown = { years = 10 }

	desc = mz_become_amazon_decision_desc

	is_shown = {
		mz_amazon_ruler_trigger = yes
		culture = { mz_is_amazonian_culture = no }
		NOR = { 
			has_global_variable = mz_amazon_culture_reformed
			#has_global_variable = mz_amazon_culture_reformation_blocker # This invisible timer starts counting down after settlements begin
			has_character_flag = mz_amazon_decision_blocker # give it a day, sheesh
		}
		has_global_variable = mz_amazon_kingdom_founded
	}

	is_valid_showing_failures_only = {
		is_available_at_peace_adult_lenient = yes
		is_female = yes
	}	

	cost = { prestige = medium_prestige_value }

	effect = {
		if = {
			limit = { 
				NOT = { has_global_variable = mz_amazon_culture_modernized }
			}
			culture = { save_scope_as = mz_old_culture }
			culture:mz_amazonian = { get_all_innovations_from = scope:mz_old_culture }
			set_global_variable = {
				name = mz_amazon_culture_modernized
				value = yes
			}
		}
		send_interface_toast = {
			title = mz_become_amazon_decision_toast
			left_icon = root
			set_culture = culture:mz_amazonian
			if = {
				limit = { 
					capital_county.culture = { mz_is_amazonian_culture = no }
				}
				capital_county = { set_county_culture = culture:mz_amazonian }
			}
		}	
		add_character_flag = converted_culture_this_lifetime		
		hidden_effect = {
			every_courtier = { 
				limit = { dynasty ?= root.dynasty }
				set_culture = culture:mz_amazonian
			}
			every_courtier_away = { 
				limit = { dynasty ?= root.dynasty }
				set_culture = culture:mz_amazonian
			}
		}
	}
}

## Adopt Amazon Faith
mz_adopt_amazon_faith_decision = {
	picture = "gfx/interface/illustrations/decisions/decision_personal_religious.dds"
	sort_order = 75
	#major = yes
	
	ai_check_interval = 0
	ai_potential = {
		is_landed = yes
		is_female = yes
	}
	ai_will_do = {
		base = 0
	}
	
	cooldown = { years = 10 }

	desc = mz_adopt_amazon_faith_decision_desc

	is_shown = {
		is_landed = yes
		exists = dynasty
		NOR = { 
			faith.religion = religion:mz_heraionism_religion # Not Heraionism or derived from such
			exists = global_var:mz_amazon_global_faith
		} 
		has_global_variable = mz_amazon_kingdom_founded
		mz_amazon_ruler_trigger = yes
		trigger_if = {
			limit = { exists = faith.religious_head }
			NOT = { this = faith.religious_head }
		}		
	}

	is_valid = {
		custom_description = {
			text = mz_adopt_amazon_faith_decision_requirements
			OR = {
				any_courtier = { faith = faith:mz_amazon_pagan }
				any_vassal = { faith = faith:mz_amazon_pagan }
			}
		}
	}

	is_valid_showing_failures_only = {
		is_available = yes
		is_imprisoned = no
		is_adult = yes
		is_at_war = no
	}	

	cost = {
		piety = {
			value = massive_piety_value
			if = {
				limit = { 
					NOT = { 
						faith = { has_doctrine = unreformed_faith_doctrine } # If faith is reformed this costs a lot
					}
				}
				add = massive_piety_value
				add = massive_piety_value
			}
			if = { 
				limit = {
					NOT = { 
						faith = { has_doctrine = pagan_hostility_doctrine } # If faith is not-pagan it costs more
					}
				}
				add = massive_piety_value
			}
			if = {
				limit = {
					culture = { mz_is_amazonian_culture = no } # More piety if non-Amazon culture
				}
				add = massive_piety_value
			}
			if = {
				limit = { has_perk = apostate_perk } # Apostate Perk reduces cost
				multiply = 0.25
			}
			round = yes
			min = major_piety_value
		}
	}

	effect = {
		set_character_faith_with_conversion = faith:mz_amazon_pagan
		if = { # Once per game, we will also trigger a cascading conversion effect. If this decision is re-used this will not happen.
			limit = {
				NOT = { has_global_variable = mz_amazon_faith_adoption_decision_used }
			}
			hidden_effect = {
				set_global_variable = {
					name = mz_amazon_faith_adoption_decision_used
					value = yes
				}				
				primary_title = {
					every_in_de_facto_hierarchy = {
						limit = {
							tier = tier_county
							OR = {
								culture = { mz_is_amazonian_culture = yes }
								AND = {
									holder.culture = { mz_is_amazonian_culture = yes }
									has_county_modifier = mz_amazon_settlements_modifier
								}
							}
						}
						if = { # If holder and county share the same Amazon culture, it's a guaranteed flip
							limit = { 
								holder.culture = { mz_is_amazonian_culture = yes }
								culture = holder.culture
							}
							set_county_faith = faith:mz_amazon_pagan
						}
						else_if = { # Settlements modifier increases the chance a bit more if the holder has the Amazon culture...
							limit = { 
								holder.culture = { mz_is_amazonian_culture = yes }
								has_county_modifier = mz_amazon_settlements_modifier 
							}
							random = {
								chance = 50
								set_county_faith = faith:mz_amazon_pagan
							}
						}
						else = { # Else, there's only a small chance.
							random = {
								chance = 25
								set_county_faith = faith:mz_amazon_pagan
							}
						}
					}
				}
			}			
		}
	}	
}

## Reform Amazon (for Amazonian cultures)
mz_reform_amazon_decision = {
	picture = "gfx/interface/illustrations/decisions/mz_decision_recruit_amazon.dds"
	sort_order = 75
	major = yes
	
	ai_check_interval = 0
	ai_potential = {
		is_landed = yes
		is_female = yes
	}
	ai_will_do = {
		base = 0
	}
	
	cooldown = { years = 50 }

	desc = mz_reform_amazon_decision_desc

	is_shown = {
		culture = { culture_head = root }
		culture = { has_cultural_tradition = mz_tradition_amazonian_matriarchy }
		culture = { mz_is_amazonian_culture = yes }
		NOR = { 
			has_global_variable = mz_amazon_culture_reformed # Already reformed
			has_global_variable = mz_amazon_culture_reformation_blocker # This invisible timer starts counting down after settlements begin
			has_character_flag = mz_amazon_decision_blocker # give it a day, sheesh
		}
		has_global_variable = mz_amazon_kingdom_founded
		mz_amazon_ruler_trigger = yes
	}

	is_valid_showing_failures_only = {
		is_available_at_peace_adult_lenient = yes
		is_female = yes
	}	

	cost = { prestige = medium_prestige_value }

	effect = {
		trigger_event = mz_amazon_alliance.3601
		custom_tooltip = mz_reform_amazon_decision_effect_tt
	}
}

## Scythian Heritage (for Scythia, Amazon culture gets Scythian language)
mz_embrace_scythian_language_decision = {
	picture = "gfx/interface/illustrations/decisions/mz_decision_recruit_amazon.dds"
	sort_order = 100
	
	ai_check_interval = 0
	ai_potential = {
		is_landed = yes
		is_female = yes
	}
	ai_will_do = {
		base = 0
	}
	
	cooldown = { days = 3650 }

	desc = mz_embrace_scythian_language_decision_desc

	is_shown = {
		culture.culture_head = root
		global_var:mz_amazon_kingdom_founded ?= flag:mz_scythia
		mz_amazon_ruler_trigger = yes
		NOT = {
			culture = { has_cultural_pillar = language_scythian }			
		}
		culture = { mz_is_amazonian_culture = yes }
	}

	is_valid = {
		custom_description = {
			text = mz_at_least_6_amazonian_counties_tt
			any_sub_realm_county = {
				count >= 6
				culture = root.culture
			}
		}		
	}

	is_valid_showing_failures_only = {
		is_capable_adult = yes
		is_imprisoned = no
		is_independent_ruler = yes
		is_female = yes
	}

	cost = {
		prestige = { value = massive_prestige_value }
	}

	effect = {
		send_interface_toast = {
			title = mz_embrace_scythian_language_decision_toast
			left_icon = root
			custom_tooltip = {
				text = mz_switch_to_scythian_language_tt
				culture = { set_culture_pillar = language_scythian }
			}
			if = {
				limit = { has_royal_court = yes }
				custom_tooltip = mz_switch_court_to_scythian_language_tt
				hidden_effect = { set_court_language = language_scythian }
			}
		}
		hidden_effect = {
			learn_language = language_scythian
			every_courtier = {
				limit = { culture = root.culture }
				learn_language = language_scythian
			}
			every_vassal_or_below = {
				limit = { culture = root.culture }
				learn_language = language_scythian				
			}
		}
	}
}

## Destroy the Great Khan
mz_destroy_the_great_khan_decision = {
	ai_check_interval = 12
	picture = "gfx/interface/illustrations/decisions/decision_destiny_goal.dds"
	major = yes
	
	sort_order = 110

	is_shown = {
		# Standard checks
		exists = dynasty
		is_landed = yes
		# Other checks
		is_independent_ruler = yes
		mz_amazon_ruler_trigger = yes # Owns one of the Amazon titles and is indepdendent
		exists = global_var:mongol_empire_has_spawned
		exists = title:e_mongol_empire.holder
		NOR = {
			any_held_title = {
				this = title:e_mongol_empire
			}
			has_character_flag = mz_challenging_mongol_empire
			has_character_flag = mz_challenged_mongol_empire
		}
		OR = {
			any_neighboring_top_liege_realm_owner = {
				any_held_title = { this = title:e_mongol_empire }
			}
			AND = {
				is_ai = no # this heavier check is for players, AI will only evaluate decision when immediately bordering the Mongols
				any_neighboring_top_liege_realm_owner = {
					any_neighboring_top_liege_realm_owner = {
						any_held_title = { this = title:e_mongol_empire }
					}
				}
			}
		}
	}

	is_valid = {
		title:e_mongol_empire.holder ?= { is_female = no }
	}

	is_valid_showing_failures_only = {
		is_female = yes
		is_available_at_peace_adult_lenient = yes
	}

	effect = {
		custom_tooltip = mz_destroy_the_great_khan_decision_effect_tt
		trigger_event = mz_mongol_empire.0001
		add_character_modifier = {
			modifier = mz_anti_khan_movement_modifier
			years = 5
		}
	}

	ai_potential = {
		exists = global_var:mongol_empire_has_spawned
		is_independent_ruler = yes
		mz_amazon_ruler_trigger = yes
	}

	ai_will_do = { # is_shown trigger means AI will only evaluate these when immediate neighbors with the Mongols
		base = 100
		# More likely if you're Craven
		modifier = {
			factor = 0.2
			has_trait = craven
		}
		# Unlikely if you're Brave
		modifier = {
			factor = 1.5
			has_trait = brave
		}
		# Unlikely if you're Arrogant
		modifier = {
			factor = 1.5
			has_trait = arrogant
		}
	}
}

## Defend against the Great Khan
mz_defend_against_the_great_khan_decision = {
	ai_check_interval = 12
	picture = "gfx/interface/illustrations/decisions/decision_destiny_goal.dds"
	major = yes
	
	sort_order = 110

	is_shown = {
		# Standard checks
		exists = dynasty
		is_landed = yes
		# Other checks
		is_independent_ruler = yes
		mz_amazon_ruler_trigger = yes # Owns one of the Amazon titles and is indepdendent
		exists = global_var:mongol_empire_has_spawned
		exists = title:e_mongol_empire.holder
		NOR = {
			any_held_title = {
				this = title:e_mongol_empire
			}
			has_character_flag = mz_challenging_mongol_empire # If we failed the Destroy the Mongol Empire CB, we can't use this decision
			has_character_flag = mz_challenged_mongol_empire
		}
		any_character_war = { # Targeted by a Mongol Invasion CB
			OR = {
				using_cb = mongol_invasion_war
				using_cb = mongol_realm_invasion_war				
			}
			primary_defender = root
			primary_attacker = title:e_mongol_empire.holder
		}
	}

	cooldown = { years = 5 }

	is_valid = {
		title:e_mongol_empire.holder ?= { is_female = no }
	}

	is_valid_showing_failures_only = {
		is_female = yes
		is_capable_adult = yes
	}

	effect = {
		add_character_modifier = {
			modifier = mz_anti_khan_movement_modifier
			years = 5
		}
		random_character_war = {
			limit = {
				OR = {
					using_cb = mongol_invasion_war
					using_cb = mongol_realm_invasion_war				
				}
				primary_defender = root
				primary_attacker = title:e_mongol_empire.holder
			}
			save_scope_as = war
		}
		root = { save_scope_as = attacker }
		mz_spawn_anti_khan_army_effect = yes
		clear_saved_scope = attacker
	}

	ai_potential = {
		exists = global_var:mongol_empire_has_spawned
		is_independent_ruler = yes
		mz_amazon_ruler_trigger = yes
		mz_has_amazon_contact = yes
	}

	ai_will_do = { base = 100 }	
}
